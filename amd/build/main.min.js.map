{"version":3,"sources":["../src/main.js"],"names":["_perPageCount","_page","_courseId","init","courseid","perpage","getEnrolmentBlockData","addLoader","on","e","loadUserModal","loadUserPagination","page","ajax","call","methodname","args","done","data","length","Templates","renderForPromise","users","then","html","js","replaceNodeContents","pagination","catch","removeLoader","fail","preventDefault","_userId","target","is","closest","_firstName","_lastName","_fullName","ModalFactory","create","title","body","modal","show","_hrefTarget","attr","handlers","getParameterByName","addClass","loadingicon","addIconToContainerWithPromise","loaderAdded","remove","resolve","removeClass"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\nimport ajax from  'core/ajax';\nimport Templates from  'core/templates';\nimport $ from 'jquery';\nimport loadingicon from \"core/loadingicon\";\nimport ModalFactory  from 'core/modal_factory';\nimport handlers from 'block_enrol_student/handlers';\n\nexport let _perPageCount = 25;\nexport let _page = 0;\nexport let _lang = [];\n\nexport let _courseId = null;\n\n/**\n * Initialize the main js and register events\n * @method\n * @param courseid\n * @param perpage\n */\nexport const init = (courseid,perpage) => {\n    _courseId = courseid;\n    _perPageCount = perpage;\n    getEnrolmentBlockData(0,addLoader());\n    $(\".enrol-student-container\").on('click', '#user_id', (e) => loadUserModal(e));\n    $('.student-block-pagination').on('click', 'ul.pagination li>a', (e) => loadUserPagination(e));\n\n};\n\n/**\n * Get Enrolment Block Data\n * @param page\n */\nexport const getEnrolmentBlockData = function (page, addLoader) {\n    ajax.call([{\n        methodname: 'block_enrol_student_enrol_student_data',\n        args: {\n            courseid: _courseId,\n            perpage: _perPageCount,\n            page: page\n        },\n        done: function (data) {\n            if (data.data.length > 0) {\n                Templates.renderForPromise(\n                    'block_enrol_student/table/users',\n                    {\n                        users: data.data\n                    }\n                ).then(({html, js}) => {\n                    Templates.replaceNodeContents('.enrol-student-container>tbody', html, js);\n                    if (data.pagination !== '') {\n                        $('.student-block-pagination').html(data.pagination);\n                    } else {\n                        $('student-block-pagination').html('');\n                    }\n                }).catch(\n\n                );\n            }\n            removeLoader(addLoader);\n        },\n        fail: function () {\n\n        }\n    }]);\n};\n\n/**\n * Load User Modal\n * @param e\n */\nexport const loadUserModal = (e) => {\n    e.preventDefault();\n    let _userId = $(e.target).is('a') ? $(\"#user_id\").data('id') : $(e.target).closest('a').data('id');\n    let _firstName = $(e.target).is('a') ? $(\"#user_id\").data('firstname') : $(e.target).closest('a').data('firstname');\n    let _lastName = $(e.target).is('a') ? $(\"#user_id\").data('lastname') : $(e.target).closest('a').data('lastname');\n    let _fullName = $(e.target).is('a') ? $(\"#user_id\").data('fullname') : $(e.target).closest('a').data('fullname');\n\n    // Create Modal Factory.\n    ModalFactory.create({\n        title: 'Student Information',\n        body: \"       <table>\\n\" +\n            \"            <tr>\\n\" +\n            \"                <th>ID</th>\\n\" +\n            \"                <th>FIRST NAME</th>\\n\" +\n            \"                <th>LAST NAME</th>\\n\" +\n            \"                <th>FULL NAME</th>\\n\" +\n            \"            </tr>\\n\" +\n            \"            <tbody>\\n\" +\n            \"\\n\" +\n            \"            <tr>\\n\" +\n            \"                <td>\" +\n            _userId +\n            \"</td>\\n\" +\n            \"                <td>\" +\n            _firstName +\n            \"</td>\\n\" +\n            \"                <td>\" +\n            _lastName +\n            \"</td>\\n\" +\n            \"                <td>\" +\n            _fullName +\n            \"</td>\\n\" +\n            \"\\n\" +\n            \"            </tr>\\n\" +\n            \"\\n\" +\n            \"            </tbody>\\n\" +\n            \"        </table>\",\n\n        // Can include JS which is run when modal is attached to DOM.\n        // body: Templates.render('block_enrol_student/modal/user', {firstname:\"eranga\" ,fullname:\"eranga kodikara\",id:_userId}),\n\n    })\n        .done(function (modal) {\n            modal.show();\n        });\n\n};\n\n/**\n *  Load User Pagination\n *  @method\n *  @param e\n */\nexport const loadUserPagination = (e) => {\n    e.preventDefault();\n    let _hrefTarget = $(e.target).is('a') ? $(e.target).attr('href') : $(e.target).closest('a').attr('href');\n    _page = handlers.getParameterByName('page', _hrefTarget);\n    getEnrolmentBlockData(_page, addLoader());\n};\n\n/**\n * Adds a loader to the screen whenever called\n *\n * @method\n * @returns {Window.jQuery|Promise|*}\n */\nexport const addLoader = () => {\n    $('.enrol-student-container').addClass('loading');\n    return loadingicon.addIconToContainerWithPromise($('.enrol-student-container'));\n};\n\n/**\n * Removes the previously added loader from the screen\n *\n * @method\n * @param loaderAdded {object} added loader to the dom\n */\nexport const removeLoader = (loaderAdded) => {\n    $('.loading-icon').remove();\n    loaderAdded.resolve();\n    $('.enrol-student-container').removeClass('loading');\n};"],"file":"main.min.js"}